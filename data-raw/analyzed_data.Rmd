---
title: "Data used for this project"
author: "Benny Salo"
date: "`r format(Sys.Date())`"
output: github_document
---

```{r message=FALSE, warning=FALSE}
library(dplyr)
```

Load data including only males. We are not authorized to make raw data publicly available.

```{r}
rm(list = ls())
FinPrisonMales <- 
  readRDS("C:/Users/benny_000/Dropbox/AAAKTUELLT/FinPrisonData/FinPrisonMales.rds")
```

We define a violent crime as crimes that belong to the homicide or assault categories. Other offence categories include offences that are violent and offences that are not violent. In many cases the violent forms are also coded as assault. 

We create variables for new violent crime

```{r}
analyzed_data <- 
  FinPrisonMales %>% 
  mutate(newO_violent = as.factor(ifelse(newO_homicide == 1 | newO_assault == 1, 
                                         "new_violent_crime", 
                                         "no_crime_or_not_violent")),
         newO_violent = relevel(newO_violent, ref ="no_crime_or_not_violent"))


table(analyzed_data$newO_violent)
```

Of the 748 new convictions 278 are categorized as prison terms for violent crimes.

Compare distributions in follow-up time between those who committed a new crime and those who did not.

```{r}
followUp_G_yes <- analyzed_data[
  analyzed_data$reoffenceThisTerm == "new_prison_sentence",
  "followUpYears"]

followUp_G_no <- analyzed_data[
  analyzed_data$reoffenceThisTerm == "not_in_prison",
  "followUpYears"]

followUp_V_yes <- analyzed_data[
  analyzed_data$newO_violent == "new_violent_crime",
  "followUpYears"]

followUp_V_no <- analyzed_data[
  analyzed_data$newO_violent == "no_crime_or_not_violent",
  "followUpYears"]
  
  
qqplot(followUp_G_yes, followUp_G_no)
qqplot(followUp_V_yes, followUp_V_no)
```

The similarity of distributions is close to perfect for general recidivism and very good for violent recidivism.

Check means and standard deviations

```{r}
analyzed_data %>% 
  group_by(reoffenceThisTerm) %>% 
  summarise(M = mean(followUpYears),
            SD = sd(followUpYears))

analyzed_data %>% 
  group_by(newO_violent) %>% 
  summarise(M = mean(followUpYears),
            SD = sd(followUpYears))

```


Save data. Will not be made public.
```{r}
saveRDS(analyzed_data, "analyzed_data.rds")
```





